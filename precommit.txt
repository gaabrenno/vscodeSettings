#!/bin/bash

# Executa o PHPStan para an√°lise est√°tica do c√≥digo
# echo "Executando PHPStan para an√°lise est√°tica..."
# ./vendor/bin/phpstan analyse --memory-limit=512M

# # Verifica o status de sa√≠da do PHPStan
# if [ $? -ne 0 ]; then
#     echo "hehe Deu ruim cumpadi.... Erros encontrados pelo PHPStan. Corrija-os antes de realizar o commit."
#     exit 1
# fi

# Executa o PHPUnit para testes automatizados em parallel
# echo "Executando textes em paralelo..."
# php artisan test --parallel
# if [ $? -ne 0 ]; then
#     echo "hehe Deu ruim cumpadi.... 1 ou mais testes deram errado. Corrija-os antes de realizar o commit."
#     exit 1
# fi

echo ""
echo ""
echo "~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~";
echo "";
echo "    --- üò† Aguenta a√≠, filh√£o, t√¥ vendo se n√£o fez bagun√ßa... üî´ ---";
echo "";
echo "~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~";
echo "";
echo "";

# Executa o Laravel Pint com corre√ß√£o autom√°tica
echo "Organizando a zona desse codigo..."
./vendor/bin/pint 

# Verifica se houve altera√ß√µes ap√≥s a execu√ß√£o do Pint
if [ -n "$(git status --porcelain)" ]; then
    echo "Corriji isso aqui √≥:"
    git status --porcelain

    # Adiciona as altera√ß√µes corrigidas ao commit
    git add -u
    echo "As altera√ß√µes corrigidas foram adicionadas ao commit... Agora √© s√≥ fazer o commit e vazar!"
else
    echo "Tava tudo ok... N√£o fez mais que sua obriga√ß√£o!"
fi
